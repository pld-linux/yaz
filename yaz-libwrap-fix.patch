--- yaz-2.1.22/configure.ac.orig	2006-06-15 15:38:05.000000000 +0200
+++ yaz-2.1.22/configure.ac	2006-07-22 15:39:52.050565250 +0200
@@ -231,6 +231,7 @@
 dnl
 dnl ------ tcpd
 AC_ARG_ENABLE(tcpd,[  --enable-tcpd[=PREFIX]  enable TCP wrapper for server if available])
+WRAPLIBS=""
 if test "$enable_tcpd" -a "$enable_tcpd" != "no"; then
     oldLibs=$LIBS
     oldCPPFLAGS=$CPPFLAGS
@@ -239,7 +240,7 @@
 	CPPFLAGS="$CPPFLAGS -I$enable_tcpd/include"
     fi
     AC_MSG_CHECKING(for working tcpd.h)
-    LIBS="$LIBS -lwrap -lnsl"
+    LIBS="$LIBS -lwrap"
     AC_TRY_LINK([#include <syslog.h>
 #include <tcpd.h>
 	    int allow_severity = LOG_INFO;
@@ -255,8 +256,11 @@
     else
 	AC_MSG_RESULT(yes)
 	AC_DEFINE(HAVE_TCPD_H)
+	WRAPLIBS="-lwrap"
     fi
+    LIBS=$oldLibs
 fi
+AC_SUBST(WRAPLIBS)
 dnl
 AC_SUBST(THREAD_CFLAGS)
 HAVETHREADS=0
--- yaz-2.0.6/src/Makefile.am.orig	2003-10-27 13:21:30.000000000 +0100
+++ yaz-2.0.6/src/Makefile.am	2003-12-07 11:14:22.779872136 +0100
@@ -64,6 +64,7 @@
   eventl.c seshigh.c statserv.c requestq.c tcpdchk.c \
   eventl.h service.c service.h session.h
 libyaz_la_LDFLAGS=-version-info $(YAZ_VERSION_INFO)
+libyaz_la_LIBADD=$(WRAPLIBS)
 
 libyazthread_la_SOURCES=
 libyazthread_la_LIBADD=thr-nmem.lo thr-statserv.lo thr-eventl.lo
