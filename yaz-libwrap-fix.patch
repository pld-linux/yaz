--- yaz-2.0/configure.in.orig	Sun Feb 23 21:18:04 2003
+++ yaz-2.0/configure.in	Tue Mar 11 11:51:10 2003
@@ -232,6 +232,7 @@
 dnl
 dnl ------ tcpd
 AC_ARG_ENABLE(tcpd,[  --enable-tcpd[=PREFIX]  enable TCP wrapper for server if available])
+WRAPLIBS=""
 if test "$enable_tcpd" != ""; then
 	oldLibs=$LIBS
 	oldCPPFLAGS=$CPPFLAGS
@@ -240,7 +241,7 @@
 		CPPFLAGS="$CPPFLAGS -I$enable_tcpd/include"
 	fi
 	AC_MSG_CHECKING(for working tcpd.h)
-	LIBS="$LIBS -lwrap -lnsl"
+	LIBS="$LIBS -lwrap"
 	AC_TRY_LINK([#include <syslog.h>
 #include <tcpd.h>
 	int allow_severity = LOG_INFO;
@@ -250,13 +251,15 @@
 	tcpd_ok=1, tcpd_ok=0)
 	if test "$tcpd_ok" = "0"; then
 		AC_MSG_RESULT(no)
-		LIBS=$oldLibs
 		CPPFLAGS=$oldCPPFLAGS
 	else
 		AC_MSG_RESULT(yes)
 		AC_DEFINE(HAVE_TCPD_H)
+		WRAPLIBS="-lwrap"
 	fi
+	LIBS=$oldLibs
 fi
+AC_SUBST(WRAPLIBS)
 dnl
 dnl ------ Headers
 AC_CHECK_HEADERS(fnmatch.h wchar.h locale.h langinfo.h)
--- yaz-2.0/server/Makefile.am.orig	Tue Feb 18 09:08:02 2003
+++ yaz-2.0/server/Makefile.am	Tue Mar 11 11:51:43 2003
@@ -5,6 +5,8 @@
 libserver_la_SOURCES = eventl.c seshigh.c statserv.c requestq.c tcpdchk.c \
  eventl.h service.h session.h
 
+LIBS = $(WRAPLIBS)
+
 EXTRA_DIST=service.c
 
 AM_CPPFLAGS=-I$(top_srcdir)/include  $(XML2_CFLAGS) -DDOCDIR=\"$(datadir)/doc/$(PACKAGE)\"
