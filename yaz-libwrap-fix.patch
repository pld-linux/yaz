--- yaz-1.8.6/configure.in.orig	Sun Mar 24 11:14:54 2002
+++ yaz-1.8.6/configure.in	Fri May  3 17:51:54 2002
@@ -144,6 +144,7 @@
 dnl
 dnl ------ tcpd
 AC_ARG_ENABLE(tcpd,[  --enable-tcpd[=PREFIX]  enable TCP wrapper for server if available])
+WRAPLIBS=
 if test "$enable_tcpd" != ""; then
 	oldLibs=$LIBS
 	oldCPPFLAGS=$CPPFLAGS
@@ -152,7 +153,7 @@
 		CPPFLAGS="$CPPFLAGS -I$enable_tcpd/include"
 	fi
 	AC_MSG_CHECKING(for working tcpd.h)
-	LIBS="$LIBS -lwrap -lnsl"
+	LIBS="$LIBS -lwrap"
 	AC_TRY_LINK([#include <syslog.h>
 #include <tcpd.h>
 	int allow_severity = LOG_INFO;
@@ -162,13 +163,15 @@
 	tcpd_ok=1, tcpd_ok=0)
 	if test "$tcpd_ok" = "0"; then
 		AC_MSG_RESULT(no)
-		LIBS=$oldLibs
 		CPPFLAGS=$oldCPPFLAGS
 	else
 		AC_MSG_RESULT(yes)
 		AC_DEFINE(HAVE_TCPD_H)
+		WRAPLIBS="-lwrap"
 	fi
+	LIBS=$oldLibs
 fi
+AC_SUBST(WRAPLIBS)
 dnl
 dnl ------ Headers
 AC_CHECK_HEADERS(fnmatch.h)
--- yaz-1.9.2/server/Makefile.am.orig	Fri May  3 17:52:47 2002
+++ yaz-1.9.2/server/Makefile.am	Fri May  3 17:52:36 2002
@@ -7,4 +7,6 @@
 
 EXTRA_DIST=service.c
 
+LIBS = $(WRAPLIBS)
+
 AM_CPPFLAGS=-I$(top_srcdir)/include 
